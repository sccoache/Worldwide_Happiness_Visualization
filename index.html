<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">

	<link rel="stylesheet" type="text/css" href="css/index.css">
	<link rel="stylesheet" type="text/css" href="css/selector.css">

	<script src="//d3js.org/d3.v4.min.js"></script>
	<script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
	<script src="https://d3js.org/topojson.v1.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

	<script src="js/cluster.js"></script>
	<script src="js/cloropleth.js"></script>
	<script src="js/selector.js"></script>
	<script src="js/happiness_barchart.js"></script>

</head>

<body >
	<h1>Visualizing Happiness Around The World</h1>

	<!-- year slider -->
	<div align="center">
	<div id="selector_div" align="center">
		<p>Selected Year: <span id="sliderVal"></span></p>
		<input type="range" min="2008" max="2016" value="2016" step="1" class="slider" id="year_range" onchange="update_page(this.value)">
	</div>
</div>

	<br>

	<!-- happiness map -->
	<div class="Map" align="center"> </div>

	<!-- cluster map -->
	<div class="Cluster">

		<div id="sidebar">
			<!-- happiness slider -->
			<section class="range-slider">
				<span class="rangeValues"></span>
				<input class="slider" id="happiness1" value="0" min="0" max="10" step="0.25" type="range" onchange="filter()">
				<input class="slider" id="happiness2" value="6" min="0" max="10" step="0.25" type="range" onchange="filter()">
			</section>
			<p class = "sidebar_p"> happiness </p>

			<!-- gdp slider -->
			<section class="range-slider">
				<span class="rangeValues"></span>
				<input class="slider" value="5" min="0" max="15" step="0.5" type="range">
				<input class="slider" value="10" min="0" max="15" step="0.5" type="range">
			</section>
			<p class = "sidebar_p"> gdp </p>
		</div>

	</div>

	<div class="bar_holder">
		<div class="happyness_bar" align="center"> </div>
		<div class="population_bar" align="center"> </div>
		<div class="gdp_bar" align="center"> </div>
		<div class="inflation_bar" align="center"> </div>
		<div class="unemployment_bar" align="center"> </div>
		<div class="alcohol_bar" align="center"> </div>
	</div>

</body>
<script>
	var slider = document.getElementById("year_range");
	var output = document.getElementById("sliderVal");
	output.innerHTML = slider.value;

	slider.oninput = function() {
  	output.innerHTML = this.value;
	}
</script>
<script>
	var year = selector();
	cloropleth(year);
	cluster(year, get_filters());
	happinessBar(year);
	populationBar(year);
	gdpBar(year);
	inflationBar(year);
	unemploymentBar(year);
	alcoholBar(year);

	// get the current filter values
	function get_filters(){
		var ids = ["happiness"];
		var filters = {};

		for(var i=0; i<ids.length; i++){
			var range;
			var one = document.getElementById(ids[i]+"1").value;
			var two = document.getElementById(ids[i]+"2").value;

			console.log(one);
			console.log(two);

			// figure out which oen is larger
			if (one*1.0 < two*1.0){
				console.log("one < two");
				filters[ids[i]] = {"smaller":one, "larger":two};
				console.log(filters.happiness.smaller);
				console.log(filters.happiness.larger);
			} else if(one === two){
				console.log("one === two");
				filters[ids[i]] = {"smaller":one, "larger":one};
				console.log(filters.happiness.smaller);
				console.log(filters.happiness.larger);
			} else {
				console.log("else...");
				filters[ids[i]] = {"smaller":two, "larger":one};
				console.log(filters.happiness.smaller);
				console.log(filters.happiness.larger);
			}
		}
		return filters;
	}

	function update_page(year){
		year = selector();
		cloropleth(year);
		cluster(year, get_filters());
		happinessBar(year);
		populationBar(year);
		gdpBar(year);
		inflationBar(year);
		unemploymentBar(year);
		alcoholBar(year);
	}

	function filter() {
		cluster(year, get_filters());
	}
</script>
</html>
